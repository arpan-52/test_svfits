JNC 21/OCt/25

More testing and debugging done on the J2000 coordinates. The code has two compile time options (a) to use SLA to do the coordinate transformation or (b) to use NOVAS. The SLA version matches the positions obtained from the 1s LTA file, and  as such seems fine. In this updated, the NOVAS routines also appear to be working fine. There may be finer issues related to use of UTC instead of UT1 in computing the hour angle. If so, this correction would also need to be made to gvfits. At the moment there is the option to read in the BulletinA corrections to get the UTC to UT1 conversion, but it is not used.

Some details on the files in this commit are given below.

antsamp.hdr - No change

fitsio.h  No change

gmrt_newcorr.h No change.

longnam.h No Change

makefile  changes associated with the option of using SLA/NOVAS for the rotation.

novascon.h header file for NOVASC

novas.h    header file for NOVASC

novas_prenut.c minor change, including IST offset when calling apparent to j2000 conversion. (Does not appear to have a measurable effect).

nutation.h header file for NOVAS

plot_flagged.py  No change

plot_postcorr.py added replacement of NaN with zeros.

Readme -- this file.

read_rawvis.py No change. This needs to be updated to reflect the fact that the raw visibility files now have the index embeded in them.

solarsystem.h Header file for NOVASC

sla_prenut.c  No Change

stats.c -- No change

SVFITS.md  usage docummentation - updated to reflect changes.

svfits.c -- added printing a message to let the user know if SLA or NOVAS is being used.

svfits.docx -- a brief report on svfits. updated  to reflect changes

svfits_par.txt -- updated to include the relevant new options.

svio.h -- update to the interface to init_mat() to allow for inclusion of IST time offset.

svsubs.c -- thread safe changes to include recomputation of the rotation matrix for every integration.

utils.c  -- various utilities for computing hour angles etc. This has been part of svfits for some time, but some how did not get included in this Readme file. Made some changes to make the use of the DUT correction optional.




